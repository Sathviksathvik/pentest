import socket
import hmac
import hashlib
import os

key = 'hello'
key1 = key.encode()
#crrate socket
server= socket.socket(socket.AF_INET,socket.SOCK_STREAM)
server.bind((socket.gethostbyname('localhost'),12345))
server.listen(1)
(client,address) = server.accept()
msg = client.recv(1024)
hash1 = client.recv(1024)

hash2 = hmac.new(msg,key1,digestmod='sha512').hexdigest()
if hash1 == hash2 :
    client.send('verified')
    client.recv(1024)
    client.send()
else :
    client.close()
    
